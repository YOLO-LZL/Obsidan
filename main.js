/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var be=Object.create;var A=Object.defineProperty;var De=Object.getOwnPropertyDescriptor;var Ce=Object.getOwnPropertyNames;var Ee=Object.getPrototypeOf,Se=Object.prototype.hasOwnProperty;var Te=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),xe=(i,t)=>{for(var e in t)A(i,e,{get:t[e],enumerable:!0})},ee=(i,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ce(t))!Se.call(i,o)&&o!==e&&A(i,o,{get:()=>t[o],enumerable:!(s=De(t,o))||s.enumerable});return i};var Le=(i,t,e)=>(e=i!=null?be(Ee(i)):{},ee(t||!i||!i.__esModule?A(e,"default",{value:i,enumerable:!0}):e,i)),Me=i=>ee(A({},"__esModule",{value:!0}),i);var re=Te((je,O)=>{(function(i){if(typeof O=="object"&&typeof O.exports=="object")O.exports=i();else if(typeof define=="function"&&define.amd)define(i);else{let t=typeof globalThis!="undefined"?globalThis:window;t.CalendarHeatmap=i()}})(function(){let t=["#ebedf0","#9be9a8","#40c463","#30a14e","#216e39"],e="calendar-heatmap-style",s={view:"year",year:new Date().getFullYear(),month:new Date().getMonth(),weekStart:0,recentDays:7,squareSize:14,squareGap:2,colorScale:t,maxValue:null,legend:!1,tooltip:!0,locale:void 0,language:"en"},o={en:{locale:"en-US",legend:{less:"Less",more:"More"},weekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],tooltip:(n,a)=>`${n} on ${a}`},"zh-cn":{locale:"zh-CN",legend:{less:"\u8F83\u5C11",more:"\u8F83\u591A"},weekdays:["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],tooltip:(n,a)=>`${a}\uFF1A${n}`},"zh-tw":{locale:"zh-TW",legend:{less:"\u8F03\u5C11",more:"\u8F03\u591A"},weekdays:["\u9031\u65E5","\u9031\u4E00","\u9031\u4E8C","\u9031\u4E09","\u9031\u56DB","\u9031\u4E94","\u9031\u516D"],tooltip:(n,a)=>`${a}\uFF1A${n}`},ja:{locale:"ja-JP",legend:{less:"\u5C11\u306A\u3044",more:"\u591A\u3044"},weekdays:["\u65E5","\u6708","\u706B","\u6C34","\u6728","\u91D1","\u571F"],tooltip:(n,a)=>`${a}\uFF1A${n}`},fr:{locale:"fr-FR",legend:{less:"Moins",more:"Plus"},weekdays:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],tooltip:(n,a)=>`${n} le ${a}`},de:{locale:"de-DE",legend:{less:"Weniger",more:"Mehr"},weekdays:["So","Mo","Di","Mi","Do","Fr","Sa"],tooltip:(n,a)=>`${n} am ${a}`},ko:{locale:"ko-KR",legend:{less:"\uC801\uC74C",more:"\uB9CE\uC74C"},weekdays:["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"],tooltip:(n,a)=>`${a} ${n}`},es:{locale:"es-ES",legend:{less:"Menos",more:"M\xE1s"},weekdays:["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"],tooltip:(n,a)=>`${n} el ${a}`},it:{locale:"it-IT",legend:{less:"Meno",more:"Pi\xF9"},weekdays:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],tooltip:(n,a)=>`${n} il ${a}`}},p={en:"en","en-us":"en","en-gb":"en",english:"en",zh:"zh-cn","zh-cn":"zh-cn","zh-hans":"zh-cn","zh-sg":"zh-cn","zh-tw":"zh-tw","zh-hant":"zh-tw","zh-hk":"zh-tw",ja:"ja","ja-jp":"ja",japanese:"ja",fr:"fr","fr-fr":"fr",french:"fr",de:"de","de-de":"de",german:"de",ko:"ko","ko-kr":"ko",korean:"ko",es:"es","es-es":"es",spanish:"es",it:"it","it-it":"it",italian:"it"};function m(n){let a=String(n||"en").toLowerCase(),r=p[a]||a;return o[r]||o.en}function v(n){if(!n)throw new Error("CalendarHeatmap: container is required.");if(typeof n=="string"){let a=document.querySelector(n);if(!a)throw new Error(`CalendarHeatmap: container selector "${n}" not found.`);return a}return n}function h(){if(typeof document=="undefined"||document.getElementById(e))return;let n=document.createElement("style");n.id=e,n.textContent=[".ch-root { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; --ch-size: 14px; --ch-gap: 2px; }",".ch-grid { display: grid; grid-auto-flow: column; grid-auto-columns: max-content; column-gap: var(--ch-gap); }",".ch-week { display: grid; grid-template-rows: repeat(7, 1fr); row-gap: var(--ch-gap); }",`.ch-day { width: var(--ch-size); height: var(--ch-size); box-sizing: border-box; border-radius: 2px; background-color: ${t[0]}; position: relative; }`,`.ch-day[data-level="0"] { background-color: ${t[0]}; }`,".ch-tooltip { position: absolute; pointer-events: none; z-index: 9999; padding: 4px 6px; border-radius: 4px; font-size: 12px; background: rgba(17, 24, 39, 0.9); color: #fff; }",".ch-legend { display: flex; align-items: center; gap: 4px; font-size: 12px; margin-top: 8px; color: #555; }",".ch-legend .ch-swatch { display: inline-block; width: var(--ch-size); height: var(--ch-size); border-radius: 2px; }",".ch-labels { display: grid; grid-template-rows: repeat(7, var(--ch-size)); row-gap: var(--ch-gap); margin-right: 6px; font-size: 10px; color: #555; }"].join(`
`),document.head.appendChild(n)}function u(n){let a=n.getFullYear(),r=String(n.getMonth()+1).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0");return`${a}-${r}-${l}`}function E(n){if(n instanceof Date)return u(n);if(typeof n=="string"){let a=n.trim(),r=new Date(a);if(!Number.isNaN(r.getTime()))return u(r)}return null}function T(n){let a=new Map;return Array.isArray(n)&&n.forEach(r=>{if(!r)return;let l=new Date(r.date||r.day||r.dateString);if(Number.isNaN(l.getTime()))return;let c=u(l),g=typeof r.value=="number"?r.value:Number(r.count);Number.isNaN(g)||a.set(c,g)}),a}function B(n,a){let r=new Date(n);return r.setDate(n.getDate()+a),r}function K(n,a){let r=new Date(n),l=(r.getDay()-a+7)%7;return r.setDate(r.getDate()-l),r.setHours(0,0,0,0),r}function J(n,a){let r=K(n,a);return B(r,6)}function ce(n,a){let r=a.weekStart%7,l,c;if(n==="year"){let d=Number(a.year);l=new Date(d,0,1),c=new Date(d,11,31)}else if(n==="month"){let d=Number(a.year),S=Number(a.month);l=new Date(d,S,1),c=new Date(d,S+1,0)}else if(n==="week"){let d=a.startDate?new Date(a.startDate):new Date;if(Number.isNaN(d.getTime()))throw new Error("CalendarHeatmap: invalid startDate for week view.");l=K(d,r),c=J(d,r)}else if(n==="recent"){let d=Math.max(Number(a.recentDays)||7,1);c=new Date,c.setHours(0,0,0,0),l=B(c,-d+1)}else throw new Error(`CalendarHeatmap: unsupported view "${n}".`);let g=K(l,r),y=J(c,r),w=[],k=new Date(g);for(;k<=y;)w.push(new Date(k)),k=B(k,1);return{start:l,end:c,alignedStart:g,alignedEnd:y,dates:w}}function de(n,a,r){let l=Array.isArray(r)&&r.length?r:t;if(typeof r=="function"){let w=r(n,a);if(typeof w=="string")return{color:w,level:n>0?1:0};if(w&&typeof w=="object"){let k=Number(w.level),d=Number.isFinite(k)?Math.max(0,Math.min(k,l.length-1)):n>0?1:0;return{color:w.color||l[d]||l[0],level:w.level!=null?d:n>0?1:0}}}if(!n||a<=0)return{color:l[0],level:0};let c=l.length-1;if(c<=0)return{color:l[0],level:n>0?1:0};let g=Math.min(n/a,1),y=Math.max(1,Math.round(g*c));return{color:l[y],level:y}}function pe(n,a,r){if(typeof document=="undefined")return null;let l=document.createElement("div");l.className="ch-labels";let c=Array.isArray(a.weekdays)&&a.weekdays.length===7?a.weekdays:null,g=c?null:new Intl.DateTimeFormat(r,{weekday:"short"});for(let y=0;y<7;y+=1){let w=(y+n.weekStart)%7,k=c?c[w]:g.format(new Date(2021,7,w+1)),d=document.createElement("span");d.textContent=k,l.appendChild(d)}return l}function ue(n,a){if(typeof document=="undefined")return null;let r=Array.isArray(n)&&n.length?n:t,l=document.createElement("div");l.className="ch-legend";let c=document.createElement("span");c.textContent=a.less,l.appendChild(c),r.forEach(y=>{let w=document.createElement("span");w.className="ch-swatch",w.style.backgroundColor=y,l.appendChild(w)});let g=document.createElement("span");return g.textContent=a.more,l.appendChild(g),l}function he(n,a){if(typeof document=="undefined")return;let r=document.createElement("div");r.className="ch-tooltip",r.style.display="none",document.body.appendChild(r);let l=g=>{let y=g.target.closest(".ch-day");if(!y||!n.contains(y)){r.style.display="none";return}r.innerHTML=a(y.dataset),r.style.display="block",r.style.left=`${g.pageX+10}px`,r.style.top=`${g.pageY+10}px`},c=()=>{r.style.display="none"};return n.addEventListener("mousemove",l),n.addEventListener("mouseleave",c),()=>{n.removeEventListener("mousemove",l),n.removeEventListener("mouseleave",c),r&&r.parentNode&&r.parentNode.removeChild(r),r=null}}class W{constructor(a,r=[],l={}){if(typeof document=="undefined")throw new Error("CalendarHeatmap: browser environment required.");this.container=v(a),this.options=Object.assign({},s,l),this.data=T(r),this.tooltipDisposer=null,h(),this.render()}setOptions(a={}){this.options=Object.assign({},this.options,a),h(),this.render()}setData(a=[]){this.data=T(a),this.render()}replaceData(a=[]){this.setData(a)}render(){let{dates:a,start:r,end:l}=ce(this.options.view,this.options),c=m(this.options.language||this.options.locale),g=this.options.locale||c.locale||void 0,y;try{y=new Intl.DateTimeFormat(g,{dateStyle:"medium"})}catch(b){y=new Intl.DateTimeFormat(g,{month:"short",day:"numeric",year:"numeric"})}let w=Array.from(this.data.values()),k=this.options.maxValue!=null?this.options.maxValue:w.reduce((b,D)=>Math.max(b,D),0),d=document.createElement("div");d.className="ch-root",d.style.setProperty("--ch-size",`${this.options.squareSize}px`),d.style.setProperty("--ch-gap",`${this.options.squareGap}px`);let S=document.createElement("div");S.style.display="flex";let Q=pe(this.options,c,g);Q&&S.appendChild(Q);let N=document.createElement("div");N.className="ch-grid";let x=[],Z=null,me=this.options.view==="year",ye=new Date,we=this.options.weekStart%7;for(let b=0;b<a.length;b+=1){let D=a[b],L=u(D);if(me&&L>u(ye))break;let I=Math.floor(b/7);Z!==I&&(x.length&&(N.appendChild(X(x)),x=[]),Z=I);let H=this.data.get(L)||0,{color:ve,level:fe}=de(H,k,this.options.colorScale),ke=(D.getDay()-we+7)%7,C=document.createElement("div");C.className="ch-day",C.style.backgroundColor=ve,C.dataset.level=String(fe),C.dataset.value=String(H),C.dataset.date=L,C.dataset.rangeStart=u(r),C.dataset.rangeEnd=u(l),C.title="",C.style.gridRowStart=String(ke+1),x.push(C)}if(x.length&&N.appendChild(X(x)),S.appendChild(N),d.appendChild(S),this.options.view==="year"&&ge(this.container,N),this.options.legend){let b=Object.assign({},o.en.legend,c.legend),D=ue(this.options.colorScale,b);D&&d.appendChild(D)}if(this.container.innerHTML="",this.container.appendChild(d),this.tooltipDisposer&&(this.tooltipDisposer(),this.tooltipDisposer=null),this.options.tooltip){let b=D=>{let L=Number(D.value)||0,I=new Date(D.date),H=Number.isNaN(I.getTime())?D.date:y.format(I);return c.tooltip?c.tooltip(L,H):o.en.tooltip(L,H)};this.tooltipDisposer=he(d,b)}}destroy(){this.tooltipDisposer&&(this.tooltipDisposer(),this.tooltipDisposer=null),this.container.innerHTML=""}}function X(n){let a=document.createElement("div");return a.className="ch-week",n.forEach(r=>{a.appendChild(r)}),a}function ge(n,a){if(typeof window=="undefined")return;let r=()=>{let l=n.clientWidth||n.getBoundingClientRect().width||0;if(l)for(;a.scrollWidth>l-40&&a.children.length>1;){let c=a.firstElementChild;if(!c)break;a.removeChild(c)}};typeof window.requestAnimationFrame=="function"?window.requestAnimationFrame(r):r()}return W.defaults=Object.assign({},s),W.languages=o,W})});var Pe={};xe(Pe,{default:()=>R});module.exports=Me(Pe);var f=require("obsidian");function te(i){let t=i.getFullYear(),e=String(i.getMonth()+1).padStart(2,"0"),s=String(i.getDate()).padStart(2,"0");return`${t}-${e}-${s}`}function Ne(i){let t=new Date(i);return isNaN(t.getTime())?null:t}function Ie(i){let t=i.match(/^\*\s+(\d{4}-\d{2}-\d{2})\s+-\s+(\d+)/);if(!t)return null;let e=Ne(t[1]),s=parseInt(t[2],10);return!e||isNaN(s)?null:{date:e,value:s}}function z(i){let t=i.split(`
`),e=[];for(let s of t){let o=Ie(s);o&&e.push(o)}return e}function G(i){let t=te(new Date);return new RegExp(`^\\*\\s+${t}\\s+-`,"m").test(i)}function ne(i,t){let e=i.lastLine(),s=i.getLine(e).length,o=He(t);i.replaceRange(`
${o}`,{line:e,ch:s})}function He(i){return`* ${te(new Date)} - ${i}`}var Ae={"notice.noActiveMarkdownView":"No active Markdown view","notice.alreadyCheckedIn":"Already checked in today","notice.editorUnavailable":"Editor instance not available","notice.onlyCheckInInEditMode":"Please switch to edit mode to check in.","notice.checkInTooFast":"You are checking in too frequently. Please wait a moment before trying again.","card.goalTitle":"My goal","card.goalPlaceholder":"Define your goal here!","card.activityHistoryTitle":"Activity history","card.buttonsTitle":"How did you do today?","card.checkInCongrats":"Another day done, you're making progress! \u{1F389}","card.defaultButton":"Button","command.insertCalendarHeatmap":"Insert calendar heatmap","command.insertCheckInComponent":"Insert check-in component","command.insertSingleCheckInComponent":"Insert single check-in component","command.insertDailyOverview":"Insert daily overview","command.insertMyGoal":"Insert my goal","snippet.justABit":"Just a bit","snippet.gotItDone":"Got it done","snippet.didExtra":"Did extra","snippet.checkIn":"Check in","setting.weekStartName":"Week start","setting.weekStartDescription":"Choose the first day of the week used by the calendar","setting.weekStart.monday":"Monday","setting.weekStart.sunday":"Sunday","overview.title":"Today's overview","overview.statusLabel":"Today's status","overview.statusValue.checkedIn":"Checked in","overview.statusValue.missed":"Missed","overview.statusHint.checkedIn":"Keep the pace","overview.statusHint.missed":"Remember to check in","overview.streakLabel":"Streak","overview.streakHint.active":"Keep it going","overview.streakHint.inactive":"Waiting to start","overview.gapLabel":"Most recent gap","overview.gapValue.none":"No gaps","overview.noData":"No data yet","overview.gapHint.present":"Review this day","overview.gapHint.none":"Looking steady","overview.streakValue":"{{count}} days"},ze={"notice.noActiveMarkdownView":"\u6CA1\u6709\u6253\u5F00\u7684 Markdown \u89C6\u56FE","notice.alreadyCheckedIn":"\u4ECA\u5929\u5DF2\u7ECF\u6253\u5361\u4E86","notice.editorUnavailable":"\u65E0\u6CD5\u83B7\u53D6\u7F16\u8F91\u5668\u5B9E\u4F8B","notice.onlyCheckInInEditMode":"\u8BF7\u5207\u6362\u5230\u7F16\u8F91\u6A21\u5F0F\u4EE5\u8FDB\u884C\u6253\u5361\u3002","notice.checkInTooFast":"\u4F60\u6253\u5361\u5F97\u592A\u9891\u7E41\u4E86\uFF0C\u8BF7\u7A0D\u7B49\u7247\u523B\u518D\u8BD5\u3002","card.goalTitle":"\u6211\u7684\u76EE\u6807","card.goalPlaceholder":"\u5728\u8FD9\u91CC\u63CF\u8FF0\u4F60\u7684\u76EE\u6807\uFF01","card.activityHistoryTitle":"\u6D3B\u52A8\u8BB0\u5F55","card.buttonsTitle":"\u4ECA\u5929\u8868\u73B0\u5982\u4F55\uFF1F","card.checkInCongrats":"\u53C8\u575A\u6301\u4E86\u4E00\u5929\uFF0C\u4F60\u6B63\u5728\u4E0D\u65AD\u8FDB\u6B65\uFF01\u{1F389}","card.defaultButton":"\u6309\u94AE","command.insertCalendarHeatmap":"\u63D2\u5165\u65E5\u5386\u70ED\u529B\u56FE","command.insertCheckInComponent":"\u63D2\u5165\u6253\u5361\u7EC4\u4EF6","command.insertSingleCheckInComponent":"\u63D2\u5165\u5355\u6309\u94AE\u6253\u5361\u7EC4\u4EF6","command.insertDailyOverview":"\u63D2\u5165\u6BCF\u65E5\u6982\u89C8","command.insertMyGoal":"\u63D2\u5165\u76EE\u6807\u5361\u7247","snippet.justABit":"\u7A0D\u5FAE\u505A\u4E86\u4E00\u70B9","snippet.gotItDone":"\u987A\u5229\u5B8C\u6210","snippet.didExtra":"\u989D\u5916\u5B8C\u6210","snippet.checkIn":"\u6253\u5361","setting.weekStartName":"\u6BCF\u5468\u8D77\u59CB\u65E5","setting.weekStartDescription":"\u9009\u62E9\u70ED\u529B\u56FE\u4E2D\u7684\u6BCF\u5468\u8D77\u59CB\u65E5","setting.weekStart.monday":"\u5468\u4E00","setting.weekStart.sunday":"\u5468\u65E5","overview.title":"\u4ECA\u65E5\u6982\u89C8","overview.statusLabel":"\u4ECA\u65E5\u72B6\u6001","overview.statusValue.checkedIn":"\u5DF2\u6253\u5361","overview.statusValue.missed":"\u672A\u6253\u5361","overview.statusHint.checkedIn":"\u4FDD\u6301\u8282\u594F","overview.statusHint.missed":"\u522B\u5FD8\u4E86\u6253\u5361","overview.streakLabel":"\u8FDE\u7EED\u5929\u6570","overview.streakHint.active":"\u7EE7\u7EED\u4FDD\u6301","overview.streakHint.inactive":"\u7B49\u5F85\u5F00\u542F","overview.gapLabel":"\u6700\u8FD1\u4E00\u6B21\u4E2D\u65AD","overview.gapValue.none":"\u6682\u65E0\u4E2D\u65AD","overview.noData":"\u6682\u65E0\u6570\u636E","overview.gapHint.present":"\u56DE\u987E\u90A3\u4E00\u5929","overview.gapHint.none":"\u8868\u73B0\u7A33\u5B9A","overview.streakValue":"{{count}} \u5929"},q={en:Ae,"zh-CN":ze},U="en",Oe=/\{\{\s*(\w+)\s*\}\}/g,Y=i=>(t,e)=>{var m,v,h;let s=(m=q[i])!=null?m:q[U],o=q[U],p=(h=(v=s[t])!=null?v:o[t])!=null?h:String(t);return e?p.replace(Oe,(u,E)=>{if(Object.prototype.hasOwnProperty.call(e,E)){let T=e[E];return T==null?"":String(T)}return u}):p},ae=i=>i?i.toLowerCase().startsWith("zh")?"zh-CN":"en":U;var M=require("obsidian"),oe=Le(re());var $=i=>{let t=i instanceof Date?i:new Date(i);return Number.isNaN(t.getTime())?"":new Date(t.getTime()-t.getTimezoneOffset()*6e4).toISOString().slice(0,10)},$e=i=>{let[t,e,s]=i.split("-").map(Number);return new Date(t,(e||1)-1,s||1)},ie=i=>{let t=new Set,e=null;for(let h of i){let u=$(h.date);u&&(t.add(u),(!e||u<e)&&(e=u))}let s=$(new Date),o=t.size>0,p=t.has(s),m=0;if(o){let h=new Date;for(p||h.setDate(h.getDate()-1);t.has($(h));)m+=1,h.setDate(h.getDate()-1)}let v=null;if(o&&e){let h=$e(e),u=new Date;for(;u>=h;){let E=$(u);if(!t.has(E)){v=E;break}u.setDate(u.getDate()-1)}}return{hasEntries:o,hasToday:p,streak:m,lastMissing:v}},se=(i,t,e)=>{var p;i.addClass("easy-tracker-card"),i.setAttr("id","easy-tracker-daily-overview"),i.createEl("div",{cls:"easy-tracker-card-title",text:e("overview.title")});let s=[{label:e("overview.statusLabel"),value:t.hasToday?e("overview.statusValue.checkedIn"):e("overview.statusValue.missed"),hint:t.hasToday?e("overview.statusHint.checkedIn"):e("overview.statusHint.missed"),modifier:t.hasToday?"easy-tracker-daily-overview__value--positive":"easy-tracker-daily-overview__value--warning"},{label:e("overview.streakLabel"),value:e("overview.streakValue",{count:String(t.hasEntries?t.streak:0)}),hint:t.hasEntries&&t.streak>0?e("overview.streakHint.active"):e("overview.streakHint.inactive")},{label:e("overview.gapLabel"),value:t.hasEntries?(p=t.lastMissing)!=null?p:e("overview.gapValue.none"):e("overview.noData"),hint:t.lastMissing?e("overview.gapHint.present"):e("overview.gapHint.none")}],o=i.createDiv({cls:"easy-tracker-daily-overview__grid"});for(let m of s){let v=o.createDiv({cls:"easy-tracker-daily-overview__item"});v.createEl("div",{cls:"easy-tracker-daily-overview__label",text:m.label});let h=v.createEl("div",{cls:"easy-tracker-daily-overview__value",text:m.value});m.modifier&&h.addClass(m.modifier),m.hint&&v.createEl("div",{cls:"easy-tracker-daily-overview__hint",text:m.hint})}};var P=class extends M.MarkdownRenderChild{constructor(e,s,o){super(s);this.heatmap=null;this.plugin=e,this.source=o,this.container=s}onload(){this.display(),this.registerEvent(this.plugin.app.workspace.on("easy-tracker:refresh",this.update.bind(this))),this.registerEvent(this.plugin.app.workspace.on("easy-tracker-setting:refresh",this.display.bind(this)))}onunload(){this.heatmap&&(this.heatmap.destroy(),this.heatmap=null)}display(){this.container.empty();let e=z(this.plugin.getActiveContent()),s=this.parseHeatmapOptions(this.source),o=this.container.createDiv({cls:"easy-tracker-card"});o.createEl("div",{cls:"easy-tracker-card-title",text:this.plugin.t("card.activityHistoryTitle")});let p=o.createDiv({cls:"easy-tracker-year-calendar-heatmap"});this.onunload(),this.heatmap=new oe.default(p,e,{weekStart:this.plugin.settings.weekStart,view:"year",year:new Date().getFullYear(),legend:!1,language:this.plugin.locale,...s})}update(){if(this.heatmap){let e=z(this.plugin.getActiveContent());this.heatmap.replaceData(e)}else this.display()}parseHeatmapOptions(e){try{return e.trim()?JSON.parse(e):{}}catch(s){return console.warn("calendar-heatmap: unable to parse options JSON, using defaults"),{}}}},V=class extends M.MarkdownRenderChild{constructor(t,e){super(e),this.plugin=t,this.container=e}onload(){this.display(),this.registerEvent(this.plugin.app.workspace.on("easy-tracker:refresh",this.display.bind(this)))}display(){this.container.empty();let t=z(this.plugin.getActiveContent()),e=ie(t);se(this.container,e,this.plugin.translator)}},_=class extends M.MarkdownRenderChild{constructor(t,e,s){super(e),this.plugin=t,this.source=s,this.container=e}onload(){this.display(),this.registerEvent(this.plugin.app.workspace.on("easy-tracker:refresh",this.display.bind(this)))}display(){this.container.empty();let t=this.container.createDiv({cls:"easy-tracker-card"});if(t.setAttr("id","easy-tracker-buttons"),t.createEl("div",{cls:"easy-tracker-card-title",text:this.plugin.t("card.buttonsTitle")}),this.plugin.isTodayCheckedIn()){t.createEl("div",{cls:"easy-tracker-card-message",text:this.plugin.t("card.checkInCongrats")});return}let e=t.createDiv({cls:"easy-tracker-button-group"}),s=this.source.split(`
`).map(o=>o.trim()).filter(Boolean);for(let[o,p]of s.entries()){let[m,v]=p.split("|").map(u=>u.trim()),h=new M.ButtonComponent(e);h.buttonEl.addClass("btn"),h.setButtonText(m||this.plugin.t("card.defaultButton")),h.onClick(()=>{let u=Number(v),E=Number.isFinite(u)?u:o+1;this.plugin.insertEntry(E)})}}};var j=require("obsidian"),le={weekStart:1},F=class extends j.PluginSettingTab{constructor(t,e){super(t,e),this.plugin=e}display(){let{containerEl:t}=this;t.empty(),new j.Setting(t).setName(this.plugin.t("setting.weekStartName")).setDesc(this.plugin.t("setting.weekStartDescription")).addDropdown(e=>{e.addOption("1",this.plugin.t("setting.weekStart.monday")),e.addOption("0",this.plugin.t("setting.weekStart.sunday")),e.setValue(String(this.plugin.settings.weekStart)),e.onChange(async s=>{this.plugin.settings.weekStart=s==="0"?0:1,await this.plugin.saveSettings()})})}};var R=class extends f.Plugin{constructor(){super(...arguments);this.locale="en";this.translator=Y("en");this.lastCheckInTime=0}t(e,s){return this.translator(e,s)}getSystemLocale(){return(0,f.getLanguage)()}refreshLocale(){let e=ae(this.getSystemLocale());this.locale=e,this.translator=Y(e),this.triggerRefresh()}triggerRefresh(){this.app.workspace.trigger("easy-tracker:refresh")}triggerSettingsRefresh(){this.app.workspace.trigger("easy-tracker-setting:refresh")}getActiveMarkdownView(){let e=this.app.workspace.getActiveViewOfType(f.MarkdownView);return e||(new f.Notice(this.t("notice.noActiveMarkdownView")),null)}getActiveContent(){let e=this.getActiveMarkdownView();return e&&e.editor.getValue()||""}isTodayCheckedIn(){let e=this.getActiveMarkdownView();if(!e)return!1;let s=e.editor.getValue()||"";return G(s)}insertEntry(e){let s=Date.now();if(s-this.lastCheckInTime<1e3)return new f.Notice(this.t("notice.checkInTooFast")),!1;this.lastCheckInTime=s;let o=this.getActiveMarkdownView();if(!o)return!1;if(o.getMode()!=="source")return new f.Notice(this.t("notice.onlyCheckInInEditMode")),!1;let p=o.editor.getValue()||"";if(G(p))return new f.Notice(this.t("notice.alreadyCheckedIn")),!1;let m=o.editor;return m?(ne(m,e),this.triggerRefresh(),!0):(new f.Notice(this.t("notice.editorUnavailable")),!1)}async onload(){await this.loadSettings(),this.refreshLocale(),this.registerMarkdownCodeBlockProcessor("easy-tracker-my-goal",(e,s,o)=>{let p=s.createDiv({cls:"easy-tracker-card"});p.setAttr("id","easy-tracker-my-goal"),p.createEl("div",{cls:"easy-tracker-card-title",text:this.t("card.goalTitle")}),p.createEl("div",{cls:"easy-tracker-my-goal",text:e.trim()||this.t("card.goalPlaceholder")})}),this.registerMarkdownCodeBlockProcessor("easy-tracker-year-calendar-heatmap",(e,s,o)=>{o.addChild(new P(this,s,e))}),this.registerMarkdownCodeBlockProcessor("easy-tracker-buttons",(e,s,o)=>{o.addChild(new _(this,s,e))}),this.registerMarkdownCodeBlockProcessor("easy-tracker-daily-overview",(e,s,o)=>{o.addChild(new V(this,s))}),this.addCommand({id:"insert-calendar-heatmap",name:this.t("command.insertCalendarHeatmap"),editorCallback:(e,s)=>{e.replaceSelection(["```easy-tracker-year-calendar-heatmap","```",""].join(`
`))}}),this.addCommand({id:"insert-check-in-component",name:this.t("command.insertCheckInComponent"),editorCallback:(e,s)=>{e.replaceSelection(["","```easy-tracker-daily-overview","```","```easy-tracker-year-calendar-heatmap","```","```easy-tracker-buttons",`  ${this.t("snippet.justABit")} | 1`,`  ${this.t("snippet.gotItDone")} | 2`,`  ${this.t("snippet.didExtra")} | 3`,"```","```easy-tracker-my-goal",this.t("card.goalPlaceholder"),"```",""].join(`
`))}}),this.addCommand({id:"insert-single-check-in-component",name:this.t("command.insertSingleCheckInComponent"),editorCallback:(e,s)=>{e.replaceSelection(["","```easy-tracker-daily-overview","```","```easy-tracker-year-calendar-heatmap","```","```easy-tracker-buttons",`  ${this.t("snippet.checkIn")} | 1`,"```","```easy-tracker-my-goal",this.t("card.goalPlaceholder"),"```",""].join(`
`))}}),this.addCommand({id:"insert-daily-overview",name:this.t("command.insertDailyOverview"),editorCallback:(e,s)=>{e.replaceSelection(["```easy-tracker-daily-overview","```",""].join(`
`))}}),this.addCommand({id:"insert-my-goal",name:this.t("command.insertMyGoal"),editorCallback:(e,s)=>{e.replaceSelection(["```easy-tracker-easy-tracker-my-goal",this.t("card.goalPlaceholder"),"```",""].join(`
`))}}),this.addSettingTab(new F(this.app,this))}onunload(){}async loadSettings(){let e=await this.loadData(),s=e==null?void 0:e.weakStart,o=typeof s!="undefined"?parseInt(String(s))===0?0:1:void 0,p={};typeof(e==null?void 0:e.weekStart)=="number"&&(p.weekStart=e.weekStart===0?0:1),typeof o!="undefined"&&(p.weekStart=o),this.settings={...le,...p}}async saveSettings(){await this.saveData(this.settings),this.triggerSettingsRefresh()}};
